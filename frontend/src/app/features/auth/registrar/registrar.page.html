<ion-header>
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-back-button defaultHref="/welcome" text=""></ion-back-button>
        </ion-buttons>
        <ion-title>Criar Conta</ion-title>
    </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
    <div class="auth-container animate-fade-in">
        <!-- Header -->
        <div class="auth-header">
            <div class="auth-logo">
                <ion-icon name="cut-outline"></ion-icon>
            </div>
            <h1>Junte-se a nós</h1>
            <p>Crie sua conta e comece agora</p>
        </div>

        <!-- Formulário de Registro -->
        <div class="auth-form">
            <form (ngSubmit)="registrar()">
                <!-- Seleção de Tipo de Usuário -->
                <div class="tipo-usuario-section">
                    <ion-text color="medium">
                        <p class="section-label">Sou um(a):</p>
                    </ion-text>
                    <ion-radio-group [(ngModel)]="tipoUsuario" name="tipoUsuario">
                        @for (tipo of tiposUsuario; track tipo.valor) {
                            <div class="tipo-card" [class.selected]="tipoUsuario === tipo.valor">
                                <ion-radio [value]="tipo.valor" labelPlacement="end">
                                    <div class="tipo-content">
                                        <ion-icon [name]="getIcone(tipo.valor)"></ion-icon>
                                        <div class="tipo-info">
                                            <strong>{{ tipo.label }}</strong>
                                            <span>{{ tipo.descricao }}</span>
                                        </div>
                                    </div>
                                </ion-radio>
                            </div>
                        }
                    </ion-radio-group>
                </div>

                <ion-list>
                    <ion-item>
                        <ion-input
                            type="text"
                            label="Nome completo"
                            labelPlacement="floating"
                            [(ngModel)]="nome"
                            name="nome"
                            autocomplete="name"
                            required
                        ></ion-input>
                    </ion-item>

                    <ion-item>
                        <ion-input
                            type="email"
                            label="Email"
                            labelPlacement="floating"
                            [(ngModel)]="email"
                            name="email"
                            autocomplete="email"
                            required
                        ></ion-input>
                    </ion-item>

                    <ion-item>
                        <ion-input
                            type="tel"
                            label="Telefone (opcional)"
                            labelPlacement="floating"
                            [(ngModel)]="telefone"
                            name="telefone"
                            autocomplete="tel"
                        ></ion-input>
                    </ion-item>

                    <ion-item>
                        <ion-input
                            type="password"
                            label="Senha"
                            labelPlacement="floating"
                            [(ngModel)]="senha"
                            name="senha"
                            autocomplete="new-password"
                            required
                        >
                            <ion-input-password-toggle slot="end"></ion-input-password-toggle>
                        </ion-input>
                    </ion-item>
                </ion-list>

                @if (erro()) {
                    <div class="error-message">{{ erro() }}</div>
                }

                <ion-button 
                    type="submit" 
                    expand="block" 
                    [disabled]="carregando()"
                >
                    @if (carregando()) {
                        <ion-spinner name="crescent"></ion-spinner>
                    } @else {
                        Criar Conta
                    }
                </ion-button>
            </form>

            <!-- Divider -->
            @if (googleSignIn.isConfigured) {
                <div class="auth-divider">
                    <span>ou registre-se com</span>
                </div>

                <!-- Botão do Google -->
                <div class="google-button-container" #googleButton></div>
            }
        </div>

        <!-- Footer -->
        <div class="auth-footer">
            <ion-button 
                fill="clear" 
                expand="block" 
                routerLink="/login"
            >
                Já tem conta? <strong>&nbsp;Faça login</strong>
            </ion-button>
        </div>
    </div>
</ion-content>
